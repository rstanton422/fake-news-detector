<!DOCTYPE html>
<!-- This is the from the template -->
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- PAge Title -->
        <title>Fake News Detector</title>
    </head>
    <body>
        <!-- -->
        <h1>Is This News Fake?</h1>
        <!-- Create test area where user will paste text to be analyzed -->
        <textarea id="article-text" rows="10" cols="60" placeholder="Please paste article text here"></textarea>
        <br><br>
        <!-- button that will be pressed by user to analzye the text-->
        <button id="analyze-btn">Press Me to Analyze</button>

        <!-- where the results from the server will be displayed-->
        <div id="result"></div>

        <script>
            /*
            This finds a button with the ID analyze-btn and "listens" for a click
            When clicked, it runs the code inside it asynchronously, 
            meaning it can wait for server responses without freezing the page
            */
            document.getElementById("analyze-btn").addEventListener("click", async function() {
                /* grabs the text in the text area */
                const text = document.getElementById("article-text").value;
                /* creates a reference to the div so it can be updates */
                const resultDiv = document.getElementById("result");
                
                /* checks if the input is empty or just spaces */
                /* if empty, its shows the message below between <p></p> */
                /* will stop executing if no text */
                if (!text.trim()) {
                    resultDiv.innerHTML = "<p>Please enter text here</p>"
                    return;
                }
                
                /* page updated with message immediately while server is chewing on information */
                resultDiv.innerHTML = "<p>Analyzing what you submitted...</p>"

                /* sends text to server using POST method */
                const response = await fetch("http://127.0.0.1:8000/analyze", {
                    method: "POST",
                    /* tells server info is being sent in JSON format */
                    headers: {
                        "Content-Type": "application/json"
                    },
                    /* Converts the JavaScript object containing text into a standard JSON string 
                    so the server can read it. */
                    body: JSON.stringify({text: text})
                });

                /* converts server reply into a usable JS object */
                const data = await response.json();

                /* final update to page after server results are received */
                resultDiv.innerHTML = "<p>Label: " + data.Label + "</p>" +
                                    "<p>Confidence: " + (data.Confidence * 100).toFixed(2) + "%</p>";
            });
        </script>    
    </body>
</html>